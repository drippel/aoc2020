package com.pfs.advent

object Day03 {

  def main(args: Array[String]): Unit = 
    Console.out.println("2020 03 01")
    val ls = parse(input)
    Console.out.println( part1( ls, (3,1) ) )
    Console.out.println( part2( ls, List( (1,1), (3,1), (5,1), (7,1), (1,2) ) ) )
  end main
  
  def parse( src : String ) =
    src.split("\n").toList.map( _.trim )
  end parse
  
  def part2( grid : List[String], slopes : List[(Int,Int)]) =
    val answers = slopes.map( part1(grid, _)).map( _.toLong )
    answers.foreach(Console.out.println(_))
    answers.foldRight(1L)( _ * _ )
  end part2
  
  def part1( grid : List[String], slope : (Int,Int) ) : Int = 
    Console.out.println("part1...")
    
    def calcNextPos( pos : (Int,Int), line : String ) =
      if( pos._1 + slope._1 >= line.length ) then 
        ( pos._1 + slope._1 - line.length, pos._2 + slope._2 )
      else 
        (pos._1 + slope._1, pos._2 + slope._2)
      
    end calcNextPos
    
    def innerPart1( pos : (Int,Int), treeCount : Int ) : Int = 
      
      if( pos._2 >= grid.length ) then 
        treeCount
      else 
        val currentLine = grid(pos._2)
        val nextCount = if( currentLine(pos._1) == '#') then
          treeCount + 1
        else
          treeCount
        val nextPos = calcNextPos( pos, currentLine )
        
        innerPart1( nextPos, nextCount )
      
    end innerPart1 
    
    innerPart1( (0,0), 0 )
  end part1
  
  val test =
    """..##.......
      #...#...#..
      .#....#..#.
      ..#.#...#.#
      .#...##..#.
      ..#.##.....
      .#.#.#....#
      .#........#
      #.##...#...
      #...##....#
      .#..#...#.#"""
  
  val input =
    """.....#....#...#.#..........#...
      ...#.................#.........
      ......#...#.#.#.....#..#.....#.
      .........#.#.............##....
      #..####..#..#.##.....#.........
      ...#........#..##...........#..
      ..##.#.#..#....#..#......#.#...
      .......#.##....#.....###....#.#
      .#..#...#......#..#....##.#....
      ...#...............#.#.....#...
      ..#............#..#.........#.#
      #.#.#.............##.#......#..
      #...#..............##...#.#....
      ...#....#................#.#..#
      ..#.#..#.#.#..#.....#.........#
      #.............#..#..........#..
      .#...#.#........###.#....#...#.
      #......#....#.#..#.##..#.......
      .##......###.#......#..##...#..
      #..#....#........#......#.#....
      .#..................#.....#.###
      .#......#.#.#.....#...#.#......
      ....#.............#.#..........
      ....#..#.#........#..###.......
      .....#....#...#........#.......
      ...........#.###....##.......#.
      ....#...........#.#..#...#.....
      ...........#.....#.#...........
      .....#........#.....#.#..#....#
      #.#......#.......#.......#.....
      ..........#.............#.#.#..
      #...#..........#....#....#.....
      .#.#......#..##...#.....#...##.
      .#....#...#.#.......#.#........
      ....#....##.##...#.............
      #...#....#..#.........#........
      ...#.....#.#...#.......#..#....
      #.......#...#....##........#..#
      ####........#........#....#.#..
      ............##..........#......
      .......#.....#.#.#.##..#...#...
      ..........#....#...##.........#
      ..##..####.......##......#.##..
      .....#.#......##...#..#...#....
      ....#.#.#.........#........#...
      ...........###...#.........##..
      .......#.#....#......#.##...##.
      .................#...##.#...##.
      .......#.......#..#.#..........
      .#....#..#....#........#.......
      ...............#.##..#...##..#.
      .###.#....#......#...#.#.....#.
      .#.....##.......#.......#......
      ....#..#.....#.....#...........
      .......#....#.................#
      .......#.##...#...#......#.....
      .#.....#...####.............#..
      ......#.........#..........#...
      .........#....#....#........###
      ....#.........#......##.....#..
      ....#........##...##.....##...#
      .#..#....#..........#...#.###.#
      #..#......#...#........#.......
      ...#.........................#.
      .............#........#........
      .......#.#.#.....##.....#..#...
      ..##..##.........#.............
      .#...#..#......#...##..##..###.
      .....#....#...#...##.##........
      .#.#..#...........#..#..#......
      ##..#...#..#...##..#....#......
      ...#...#...#.........#....###..
      ...##..#....#.#.#.......#...#..
      ..#.#.....#..#....#..##.......#
      .....#.#.....#......#....#.#...
      .......##....#.....#...#.....#.
      ..##..#.................#.#....
      ..............##....##.#..##...
      .#..#.....#....#.#.#...........
      ......#.#.#..#..#...#.....#..##
      ..#.........#.#.......###...##.
      #.....#...........#.....#.##.#.
      #..........#....#....#..#....#.
      .#.....#...#.......###......#..
      ....##..##......#....#....#....
      .......#.#.............#....#.#
      .#..#.##.##.##....#.#.....##.##
      ....#..##.#..#.............##..
      ....#...........#...#....#..#..
      ...........#..#....#....##.#.##
      ......#....#....#.....#......#.
      .##.##....#.....#.#......#...#.
      .....##.......#.#.#........##..
      #..........##..#....#..#.#....#
      ...#...........................
      ...#..#...#..#.#.#.#.......#.#.
      .....#.........#..###..........
      ...#.#......##....#......#..###
      #..............#....#.......#..
      .........##......###..###......
      ..#......##...........#.##.....
      #.#..#......#...##.............
      ......#.#.............#....#..#
      #.....##..#.#.................#
      ..##....#.....#....#.....###...
      .#.#.##.....#..................
      .#......#.#.#.....#..#....#....
      ..#.#.....##.#...#..#.#.##.....
      ..#.#..#......##.#.#..........#
      .......##.....#..#...#....##.#.
      ...#.....#..........#..........
      ......................##......#
      ...###.........##.........#....
      ....#..................#.....#.
      .##..#.............#........##.
      ....#....#...###..........#....
      .....#.#..........###..........
      ..#......##......#.#.##.#..#...
      ##...........#.#..#.....#..#...
      .........#......#..........#.#.
      ...#.##.#..#..###..#...........
      ....##.#.##...........#.....##.
      ....#...................###....
      #.......#......#......#.....#..
      #..........##..................
      ...#..#.#....#..#.........##.#.
      ......#...##.#...............#.
      .........#....#.#...#..#..#....
      ...#......###..#......#.....#.#
      #..###.#.............#.........
      ......#...........#............
      ..#..#.##.....#......#.#..#...#
      .........#..............#......
      ........#.....#..#...#.....#..#
      .....................#........#
      .##.......##...#.###.........#.
      .#...#.......#.#....##....#....
      ........#......#...........#.#.
      ....#......##...#.....#...#...#
      ..#.........#.#...............#
      ....#.....#......#.............
      .............##.....#....#.....
      ........#......#.#.....#....#..
      #.........#...#......#....#...#
      .#........###...#.#.#...#....#.
      .###...........#..#............
      ....##.........#..#...##.#..###
      .####..#.#...............##.#..
      #.....#...#....#.......##....#.
      ..#.....##...##.#...#..#.......
      ..#.###.......#.....#.......#..
      ...........#.......#....##....#
      ..#...#....##........###......#
      ...#..#..............#...#.....
      ##.#.............#....##.#..##.
      ##.#..#..............#.#.......
      .......#....#....##............
      .##..##.#..........#.#...#.#...
      .........##.......##...#...#...
      ............#...##....#...#....
      ........#...#..#...#.##......#.
      ..#...#.#.........#.#....#.....
      ..#...#.#..#.......#.#.........
      .......#.....#...#.#..###....#.
      .#......#.#....#.#.####....#...
      .......##..#......#...#......##
      #####.....#........#.#.......#.
      .....#...#..#...#.#.....#..#...
      ....#...#....##.....##....#.#..
      .#..#......#.####.....#....#..#
      ...#.......#..#.....##........#
      .#.....#.#.#.....##...#..#.....
      .............#...#..#.....#....
      ...#.....##.......#...##..#...#
      ..#.............#...#..#..##...
      ...#........#........#...#...#.
      ##..........#.#.#.............#
      ....#....#..............#..#...
      ....#..####..##....#.......#.#.
      .#..#.....##....#.#.....#...#..
      #............##..#..#.#......#.
      ....#..........##..#...........
      ..#.##.#.......#...#.##....#...
      ....#.#.............#.#.##....#
      ...#..#.#.#......#..#....#....#
      .............#...........#..#..
      #.............##.......#..###..
      ..##....#.#.#...#...#....#...#.
      ##.......####........##..#.....
      .###..#..#..#..#...#.#.........
      ............#............#.....
      #...#.....#.#.##.##...#.......#
      #........#....#...#.........#..
      #....#.#......#.............#..
      ....#............#......##...#.
      .......#........#..#.......#..#
      #.#...#.#.#..#..#........#....#
      #.#.##...........#.....#.....#.
      .#...##.#..#...................
      ###...#.#.....................#
      .#....##...##.#....#..#........
      ........###...#.#....##...#..##
      ...#..#..........###..#.......#
      ..#..##.............#.....#....
      ....##..#..............#.......
      ...##...##.#....#.#...#...#.#.#
      ..#..........#.....##........#.
      .#.#.....#......#..#....#......
      ...##.#....#.......#......#....
      ...##..#........##......#..##..
      #..###...#...........#.#.......
      ..##...#...#.#.#...#.#.....#...
      ..#.....##.#....#.....#..#.....
      ..#.#......#.......#...........
      ....##......##.............#..#
      .......#.........##...#..#...#.
      .#........#.##.#.....#.#.......
      #..#...#..#.....##...........#.
      ..##..............#....#.......
      .#..#....#.#...........#..##.#.
      #....#..###..........#...#.....
      .......#...##........#.#...###.
      ....#..#......##......#.....#..
      .#..##..#..#......#......#.##..
      ....#.#...........#..#.#.##.#..
      .....#......#.....#.....#..#...
      ..........#...........#...##...
      #..#.#.#..#....#.....##......##
      ..#.....#.....#................
      ...#.#..##.........#..#..##....
      .#.....##..#.#.#.#.....#.......
      ...........##...#..............
      ...#.#....##..#.............###
      ...#.#...........#.........#...
      #.....#.....##..#.#.#.#....#...
      ##..................##.##......
      ......#.....#....#.....#..#...#
      .............#.......#....#..##
      .#..#.##..#..#.........##...#..
      ..#.#....#........#....#....##.
      .#.#.#.#.#.......#.......#..#..
      #.....#..##..#.........#.......
      .............#.#..............#
      .........#......#....#.#......#
      .........#.#...##..#.#.........
      ...........#..........#........
      .......#...#...#......#..#.....
      #.....#...............#.....#.#
      ..#....#..........#.#...#..#...
      #....##..#..#.....#.#..#.#.....
      .#....#..###............##.....
      ......#.##...........#....#..#.
      ...#........##....#...#...#....
      ..#.#.#.....#..#.#..........##.
      ..................#...........#
      ##........#.#......#.#.......#.
      ......#..#.............##......
      .#..###..#...###......#....#..#
      ..#...........#...#...##..#...#
      ..#..........#..............#..
      .....#.........................
      ..#.#..##...........##...#.....
      ...........#......##.....##....
      ......#.......#................
      .........#.......#.#...........
      #......#...#........##.....##..
      ...#.....#....#..#.....#.......
      ....#.#......#...#..#.##.##...#
      ..#..#.#.....#...#...........#.
      .#....##.####.....#..........##
      ...##.##.....##..###...#.......
      .......#.#...#....#.......#..#.
      .#..#.###.#.............#......
      .###.........####..#...........
      #..#.#.###.....#.......#.......
      .#.....#.....#.....#.........#.
      ..#...#......#.......##.###....
      .......##.............##.#.....
      .....................#.....##.#
      ##.#...#........#..##........#.
      ...#..........#.#.#..#......###
      .#....#.#.#..........##........
      ....#....####....#.#....#..#.#.
      ..#.........#....##..........##
      ...##.#.......##.#.......#.#...
      ........#..#......#...#.#.....#
      .....##............#.#.......#.
      .........##...##..#.....#..#...
      #...#....#........#...#....##.#
      ..#.....#..........#...##.....#
      .##..#.........#...........#...
      .....##.#.#.#.#..#...#.....#.#.
      .#..#..##.........#.......#...#
      #....#.....#...#....#.........#
      ...#..#.......#.........#......
      .#....##..#......##.#.#......#.
      ....##.##...........#...#......
      ..#.#....#.##...#......#.......
      ...#........#.............#....
      ...##....................#.###.
      .#.......#.........#......##...
      ....#..#..............#....#...
      ....##.#............#..........
      .#...#....#...##..........#....
      ....#............#.....#.......
      .......#........#..............
      ....#.#....#.#..#..#...........
      ......................#.#......
      #......##.....#..#.......##....
      ...#........#........#.#...##..
      ##.#....##....#................
      #..#....#..............#.##....
      ......#........#...........#...
      #....##.##...#...#..#...##.....
      ............#............#..#..
      #....#...#..#..#.#...........#.
      .......#..........#..........##
      .....#......#....##.#..........
      .#....#....#....#....#..#...#..
      .....###....#...#.#.#........#.
      .......#...#..........##..#...#
      ..##........................##.
      .....#....#..............#....#""".stripMargin

}
